<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T8U3">x_aposteriori</span>] = kalman_dlqe2(<span class="var type1" id="S3T2U6">dt</span>,<span class="var type1" id="S4T2U7">k1</span>,<span class="var type1" id="S5T2U8">k2</span>,<span class="var type1" id="S6T2U9">k3</span>,<span class="var type1" id="S7T8U10">x_aposteriori_k</span>,<span class="var type1" id="S8T2U11">z</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line">    <span class="mxinfo" id="T2:U8"><span class="var type1" id="S9T2U14">st</span> = <span class="mxinfo" id="T2:U10">1/2*<span class="mxinfo" id="T2:U11"><span class="var type1" id="S3T2U20">dt</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    <span class="mxinfo" id="T7:U13"><span class="var type1" id="S10T7U24">A</span> = <span class="mxinfo" id="T7:U15">[<span class="mxinfo" id="T14:U16"><span class="mxinfo" id="T1:U17">1</span>,<span class="var type1" id="S3T2U28">dt</span>,<span class="var type1" id="S9T2U29">st</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T7:U13"><span class="mxinfo" id="T7:U15">        <span class="mxinfo" id="T14:U20"><span class="mxinfo" id="T1:U21">0</span>,<span class="mxinfo" id="T1:U22">1</span>,<span class="var type1" id="S3T2U33">dt</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo" id="T7:U13"><span class="mxinfo" id="T7:U15">        <span class="mxinfo" id="T13:U24"><span class="mxinfo" id="T1:U25">0</span>,<span class="mxinfo" id="T1:U26">0</span>,<span class="mxinfo" id="T1:U27">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo" id="T13:U28"><span class="var type1" id="S11T13U40">C</span>=<span class="mxinfo" id="T13:U30">[1,0,0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T8:U31"><span class="var type1" id="S12T8U48">K</span> = <span class="mxinfo" id="T8:U33">[<span class="var type1" id="S4T2U51">k1</span>;<span class="var type1" id="S5T2U53">k2</span>;<span class="var type1" id="S6T2U55">k3</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo" id="T8:U37"><span class="var type1" id="S2T8U58">x_aposteriori</span>=<span class="mxinfo" id="T8:U39"><span class="mxinfo" id="T8:U40"><span class="var type1" id="S10T7U61">A</span>*<span class="var type1" id="S7T8U62">x_aposteriori_k</span></span>+<span class="mxinfo" id="T8:U43"><span class="var type1" id="S12T8U64">K</span>*(<span class="mxinfo" id="T2:U45"><span class="var type1" id="S8T2U67">z</span>-<span class="mxinfo" id="T2:U47"><span class="mxinfo" id="T14:U48"><span class="var type1" id="S11T13U70">C</span>*<span class="var type1" id="S10T7U71">A</span></span>*<span class="var type1" id="S7T8U72">x_aposteriori_k</span></span></span>)</span></span></span>;      </span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
